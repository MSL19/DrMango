<!DOCTYPE html>
<html>
<body>
<p id = "test"></p>
<button id="runNext">Run Next Generation</button>
<canvas id="myCanvas" width="500" height="500" style="border:1px solid #d3d3d3;">
</canvas>

<script>
//GLOBAL VARS
var c = document.getElementById("myCanvas");
var ctx = c.getContext("2d");
var genePool = ["0000", "1111"];
var initX = Math.floor(Math.random()*401);
var initY = Math.floor(Math.random()*401);
var prevXDir = ["0","0"];
var prevYDir =["0","0"];
var deltaBrightness = [0,0];
var prevBrightness = [0,0];
var xArr = [0,0];
var yArr = [0,0];
//GRADIENT



    var updateClock = setInterval(mainUpdate, 100);
//MANGO
//input: Delta Brightness, previous direction
//basically its and array of strings
//the string consists of "+" and "-" 
//eg: ++-- ----

//each one is a case 
//eg the first case is posDeltaGrightness, previous direction of posX, result posX, so it would be a bad "gene" 
//if the delta brightness is negative and the direction gene is negative then the thing will keep going the same direction
//the positions of each are in arrays of ints, one for each axis
	function createMangos(){
		for(var i = 0; i<16; i++){
			var tempGene = "";
			for(var j = 0; j<8; j++){
				if(Math.floor(Math.random()*2)>0){
					tempGene+="+"
				}
				else{
					tempGene+="-";
				}
			}
			genePool[genePool.length] = tempGene; 
			xArr[xArr.length] = initX;
			yArr[yArr.length] = initY;
            prevXDir[prevXDir.length] = "+";
            prevYDir[prevYDir.length] = "+";
            prevBrightness[prevBrightness.length] = calcBrightness(initX, initY);
            deltaBrightness[deltaBrightness.length] = 1;
			console.log(tempGene);
		}
		
	}
	
	
createMangos();

	function mainUpdate(){
		ctx.clearRect(0, 0, 500, 500); //DELETE THIS TO SHOW THE PATHS!!!!!!!!!!!
        var light = ctx.createRadialGradient(150, 150, 0, 200, 200, 350);
        light.addColorStop(0, "white");
        light.addColorStop(1, "black");
        ctx.fillStyle = light;
        ctx.fillRect(0, 0, 500, 500);
		for(var k = 0; k<16; k++){
		updatePos(k);
		drawMango(xArr[k+2], yArr[k+2]);
		}

        
	}


    var i = 0;
    function updatePos(gNum) {
        //+++++++++++++++++
        console.log("asdsada");
        if(deltaBrightness[gNum+2]>0){ //this is bad
                if(prevXDir=="+"){
                    if(genePool[gNum+2].charAt(0)=="+"){
                        prevXDir[gNum+2] = "+";
                        xArr[gNum+2]+=1; //+DB, +dir, +add === bad
                    }
                    else{
                        prevXDir[gNum+2] = "-"; //good
                        xArr[gNum+2]-=1;
                    }
                }
                else{
                    if(genePool[gNum+2].charAt(1)=="-"){
                        prevXDir[gNum+2] = "-"; //bad
                        xArr[gNum+2]-=1;
                    }
                    else{
                        prevXDir[gNum+2] = "+";
                        xArr[gNum+2]+=1;
                    }
                }
                if(prevYDir=="+"){
                    if(genePool[gNum+2].charAt(2)=="+"){
                        prevYDir[gNum+2] = "+";
                        yArr[gNum+2]+=1;
                    }
                    else{
                        prevYDir[gNum+2] = "-";
                        yArr[gNum+2]-=1;
                    }
                }
        }
// code that looks at the gens and returns new positions to the array

		
       
    }
    
    function drawMango(xCord, yCord){
      ctx.beginPath();
      ctx.arc(xCord, yCord, 5, 0, 2 * Math.PI, false);
      ctx.fillStyle = 'orange';
      ctx.fill();
      ctx.lineWidth = 0;
      ctx.strokeStyle = '#003300';
      ctx.stroke();
    }

//DISTANCE RELATED CALCS
    function calcDistance(xCord, yCord) {
        var xDist = Math.abs(xCord - 150);
        var yDist = Math.abs(yCord - 150);
        return Math.sqrt(Math.pow(xDist, 2) + Math.pow(yDist, 2));

    }

    function calcBrightness(xCord, yCord) {
        if (calcDistance(xCord, yCord) == 0){
        
         return 1;
         }
        else{
         
         return 1 / calcDistance(xCord, yCord);
         }
    }
    
   

    function calcFitness(xCord, yCord) {
        return calcDistance(xCord, yCord) / 494;
    }
    
    
</script>

</body>
</html>
